
|

.. _quick-start_train:

Quick Start Guide: train
==========================

This guide walks you through the essentials of using the ``train`` subcommand to build an OpenSpliceAI model for splice site prediction. It converts HDF5 datasets (generated by the ``create-data`` subcommand) into a trained deep learning model.

|

Before You Begin
----------------

- **Dataset Preparation**: Ensure you have created the training and testing datasets using the ``create-data`` subcommand.  
  Example files: ``dataset_train.h5`` and ``dataset_test.h5``.

- **Installation**: Follow the instructions on the :ref:`Installation` page to install OpenSpliceAI and its dependencies.

- **Repository Setup**: Clone the OpenSpliceAI repository from 
  `LiftOn OpenSpliceAI <https://github.com/Kuanhao-Chao/OpenSpliceAI>`_ and review the sample scripts (e.g., `test/lifton_chr22_example.sh <https://github.com/Kuanhao-Chao/LiftOn/tree/main/test/lifton_chr22_example.sh>`_).


|

Super-Quick Start (One-Liner)
-----------------------------

Suppose you have the following files:
 
1. **Training Dataset**: ``dataset_train.h5``  
2. **Testing Dataset**: ``dataset_test.h5``  
3. **Desired Flanking Size**: 10,000 nt

Run this command to train your model:

.. code-block:: bash

   openspliceai train --flanking-size 10000 \
      --exp-num full_dataset \
      --train-dataset /path/to/dataset_train.h5 \
      --test-dataset /path/to/dataset_test.h5 \
      --output-dir /path/to/model_train_outdir/ \
      --project-name human_MANE_adaptive_lr \
      --random-seed 22 \
      --model SpliceAI \
      --loss cross_entropy_loss \
      -d

This command will:
- Load your training and testing HDF5 files.
- Initialize and train the SpliceAI model using the specified flanking size.
- Apply adaptive learning rate scheduling and early stopping.
- Save model checkpoints (e.g., ``model_best.pt``) and logs in the output directory.


|

Next Steps
----------

- **Calibration**: Fine-tune the probability outputs using the :ref:`calibrate_subcommand`.
- **Prediction**: Use the :ref:`predict_subcommand` to run inference on new DNA sequences.
- **Advanced Options**: Explore additional training parameters (e.g., epochs, patience) for customized training.


|

Congratulations!
----------------

You have successfully initiated the training process with OpenSpliceAI. For more details on hyperparameters, logging, and advanced configurations, please consult the full documentation.

|
|
|
|
|


.. image:: ../../_images/jhu-logo-dark.png
   :alt: My Logo
   :class: logo, header-image only-light
   :align: center

.. image:: ../../_images/jhu-logo-white.png
   :alt: My Logo
   :class: logo, header-image only-dark
   :align: center